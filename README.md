# Wound Band-Aid Overlay (Deepskin + OpenCV)

This script detects a wound region from a segmentation mask generated by:

- https://github.com/Nico-Curti/Deepskin

Then it overlays a rotated/scaled band-aid on the wound and shows original vs modified image.

## Requirements

- Python 3.9+
- `opencv-python`, `numpy`, `matplotlib`
- Local clone of `Nico-Curti/Deepskin`

```bash
pip install opencv-python numpy matplotlib
```

## Usage

```bash
python wound_bandaid.py \
  --input arm.jpg \
  --seg-repo /path/to/Deepskin
```

Batch run:

```bash
python wound_bandaid.py \
  --input-dir wound_images \
  --seg-repo /path/to/Deepskin
```

### Important

- `--seg-command` must contain `{input}` (absolute input image path).
- `{mask}` is optional. If omitted, the script looks for `<input>_deepskin_mask.png` next to the input file (Deepskin CLI default).
- Use `--mask-out mask.png` if you want to keep the generated mask.
- Use `--fallback-heuristic` to fall back to redness detection if model inference fails.
- Use `--bandaid my_bandaid.png` to provide custom RGBA overlay.
- For batch runs, outputs are written to `wound_images/output`, masks to `wound_images/masks`, and overlays to `wound_images/overlays` (override with `--output-dir`, `--mask-dir`, `--overlay-dir`).
- Blending uses OpenCV; default is `--blend seamless`.
- If the mask is RGB, the green channel is treated as skin. The band-aid is clipped to skin, and wrapping only affects the end that extends beyond skin (when the opposite end is on skin).
- Use `--workers N` to process batch images concurrently.
